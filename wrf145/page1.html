<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AQL抽样方案查询工具</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
            padding: 0 10px 50px;
        }
        
        .header {
            background: linear-gradient(135deg, #07c160, #05a049);
            color: white;
            padding: 15px 20px;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .header h1 {
            font-size: 18px;
            font-weight: 500;
        }
        
        .container {
            max-width: 800px;
            margin: 20px auto;
        }
        
        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            margin-bottom: 20px;
            overflow: hidden;
        }
        
        .card-header {
            padding: 16px 20px;
            border-bottom: 1px solid #eee;
            font-weight: 500;
            color: #07c160;
            display: flex;
            align-items: center;
        }
        
        .card-header i {
            margin-right: 10px;
            font-size: 18px;
        }
        
        .card-body {
            padding: 20px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #555;
        }
        
        input[type="number"], select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            background: #fafafa;
            transition: all 0.2s;
        }
        
        input[type="number"]:focus, select:focus {
            border-color: #07c160;
            outline: none;
            box-shadow: 0 0 0 2px rgba(7, 193, 96, 0.2);
        }
        
        .radio-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 5px;
        }
        
        .radio-option {
            flex: 1;
            min-width: 80px;
            text-align: center;
        }
        
        .radio-option input[type="radio"] {
            display: none;
        }
        
        .radio-option label {
            display: block;
            padding: 12px 5px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: #fafafa;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .radio-option input[type="radio"]:checked + label {
            border-color: #07c160;
            background: rgba(7, 193, 96, 0.1);
            color: #07c160;
            font-weight: 500;
        }
        
        .btn {
            display: block;
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #07c160, #05a049);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }
        
        .btn:hover {
            opacity: 0.9;
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(7, 193, 96, 0.3);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .result-card {
            display: none;
        }
        
        .result-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #eee;
        }
        
        .result-item:last-child {
            border-bottom: none;
        }
        
        .result-label {
            font-weight: 500;
            color: #666;
        }
        
        .result-value {
            font-weight: 600;
            color: #07c160;
        }
        
        .important {
            color: #e53935;
            font-weight: 600;
        }
        
        .rules {
            background: #fff8e1;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin-top: 20px;
            border-radius: 0 8px 8px 0;
        }
        
        .rules h3 {
            margin-bottom: 10px;
            color: #333;
        }
        
        .rules ul {
            padding-left: 20px;
        }
        
        .rules li {
            margin-bottom: 8px;
        }
        
        .footer {
            text-align: center;
            margin-top: 30px;
            color: #888;
            font-size: 14px;
        }
        
        @media (max-width: 600px) {
            .radio-option {
                min-width: 70px;
            }
            
            .card-body {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 16px;
            }
        }
    </style>
</head>

<body>
    <div class="header">
        <h1>GB/T2828.1-2012 抽样方案查询</h1>
    </div>

    <div class="container">
        <div class="card">
            <div class="card-header">
                <i class="fas fa-calculator"></i> 抽样参数设置
            </div>
            <div class="card-body">
                <div class="form-group">
                    <label for="lotSize">批量 (N)</label>
                    <input type="number" id="lotSize" min="2" placeholder="请输入产品批量">
                </div>

                <div class="form-group">
                    <label>检验水平</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="level-s1" name="inspectionLevel" value="S-1">
                            <label for="level-s1">S-1</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="level-s2" name="inspectionLevel" value="S-2">
                            <label for="level-s2">S-2</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="level-s3" name="inspectionLevel" value="S-3">
                            <label for="level-s3">S-3</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="level-s4" name="inspectionLevel" value="S-4">
                            <label for="level-s4">S-4</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="level-i" name="inspectionLevel" value="I">
                            <label for="level-i">I</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="level-ii" name="inspectionLevel" value="II" checked>
                            <label for="level-ii">II</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="level-iii" name="inspectionLevel" value="III">
                            <label for="level-iii">III</label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>检验类型</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="type-normal" name="inspectionType" value="normal" checked>
                            <label for="type-normal">正常检验</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="type-tightened" name="inspectionType" value="tightened">
                            <label for="type-tightened">加严检验</label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="aql">接收质量限 (AQL)</label>
                    <select id="aql">
                        <option value="0.010">0.010</option>
                        <option value="0.015">0.015</option>
                        <option value="0.025">0.025</option>
                        <option value="0.040">0.040</option>
                        <option value="0.065">0.065</option>
                        <option value="0.10">0.10</option>
                        <option value="0.15">0.15</option>
                        <option value="0.25" selected>0.25</option>
                        <option value="0.40">0.40</option>
                        <option value="0.65">0.65</option>
                        <option value="1.0">1.0</option>
                        <option value="1.5">1.5</option>
                        <option value="2.5">2.5</option>
                        <option value="4.0">4.0</option>
                        <option value="6.5">6.5</option>
                        <option value="10">10</option>
                        <option value="15">15</option>
                        <option value="25">25</option>
                        <option value="40">40</option>
                        <option value="65">65</option>
                        <option value="100">100</option>
                        <option value="150">150</option>
                        <option value="250">250</option>
                        <option value="400">400</option>
                        <option value="650">650</option>
                        <option value="1000">1000</option>
                    </select>
                </div>

                <button id="calculateBtn" class="btn">
                    <i class="fas fa-search"></i> 计算抽样方案
                </button>
            </div>
        </div>

        <div class="card result-card" id="resultCard">
            <div class="card-header">
                <i class="fas fa-clipboard-list"></i> 抽样方案结果
            </div>
            <div class="card-body">
                <div class="result-item">
                    <span class="result-label">样本量字码:</span>
                    <span class="result-value" id="sampleCode">D</span>
                </div>
                <div class="result-item">
                    <span class="result-label">样本量 (n):</span>
                    <span class="result-value" id="sampleSize">80</span>
                </div>
                <div class="result-item">
                    <span class="result-label">接收数 (Ac):</span>
                    <span class="result-value" id="acceptanceNumber">5</span>
                </div>
                <div class="result-item">
                    <span class="result-label">拒收数 (Re):</span>
                    <span class="result-value" id="rejectionNumber">6</span>
                </div>
                <div class="result-item">
                    <span class="result-label">判定规则:</span>
                    <span class="result-value" id="decisionRule">d ≤ Ac 接收，d ≥ Re 拒收</span>
                </div>
            </div>
        </div>

        <div class="rules">
            <h3><i class="fas fa-info-circle"></i> 抽样规则说明</h3>
            <ul>
                <li><span class="important">Ac = 允收数</span>，<span class="important">Re = 拒收数</span></li>
                <li>当样本数等于或大于批量时，进行全数检验</li>
                <li>d = 样本中发现的不合格品数</li>
            </ul>
        </div>
    </div>

    <div class="footer">
        <p>计数抽样检验程序</p>
        <p>@ 2025 品质管理工具 | 数据基于GB/T 2828.1-2012/IS0 2859-1:1999最新国标</p>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const calculateBtn = document.getElementById('calculateBtn');
            const resultCard = document.getElementById('resultCard');
            
            // 样本量字码映射表
            const codeMap = [
                { min: 2, max: 8, s1: 'A', s2: 'A', s3: 'A', s4: 'A', g1: 'A', g2: 'A', g3: 'B' },
                { min: 9, max: 15, s1: 'A', s2: 'A', s3: 'A', s4: 'A', g1: 'A', g2: 'B', g3: 'C' },
                { min: 16, max: 25, s1: 'A', s2: 'A', s3: 'B', s4: 'B', g1: 'B', g2: 'C', g3: 'D' },
                { min: 26, max: 50, s1: 'A', s2: 'B', s3: 'B', s4: 'C', g1: 'C', g2: 'D', g3: 'E' },
                { min: 51, max: 90, s1: 'B', s2: 'B', s3: 'C', s4: 'C', g1: 'C', g2: 'E', g3: 'F' },
                { min: 91, max: 150, s1: 'B', s2: 'B', s3: 'C', s4: 'D', g1: 'D', g2: 'F', g3: 'G' },
                { min: 151, max: 280, s1: 'B', s2: 'C', s3: 'D', s4: 'E', g1: 'E', g2: 'G', g3: 'H' },
                { min: 281, max: 500, s1: 'B', s2: 'C', s3: 'D', s4: 'E', g1: 'F', g2: 'H', g3: 'J' },
                { min: 501, max: 1200, s1: 'C', s2: 'C', s3: 'E', s4: 'F', g1: 'G', g2: 'J', g3: 'K' },
                { min: 1201, max: 3200, s1: 'C', s2: 'D', s3: 'E', s4: 'G', g1: 'H', g2: 'K', g3: 'L' },
                { min: 3201, max: 10000, s1: 'C', s2: 'D', s3: 'F', s4: 'G', g1: 'J', g2: 'L', g3: 'M' },
                { min: 10001, max: 35000, s1: 'C', s2: 'D', s3: 'F', s4: 'H', g1: 'K', g2: 'M', g3: 'N' },
                { min: 35001, max: 150000, s1: 'D', s2: 'E', s3: 'G', s4: 'J', g1: 'L', g2: 'N', g3: 'P' },
                { min: 150001, max: 500000, s1: 'D', s2: 'E', s3: 'G', s4: 'J', g1: 'M', g2: 'P', g3: 'Q' },
                { min: 500001, max: Infinity, s1: 'D', s2: 'E', s3: 'H', s4: 'K', g1: 'N', g2: 'Q', g3: 'R' }
            ];
            
            // 样本量对应表
            const sampleSizeMap = {
                'A': 2, 'B': 3, 'C': 5, 'D': 8, 'E': 13, 'F': 20, 'G': 32, 
                'H': 50, 'J': 80, 'K': 125, 'L': 200, 'M': 315, 'N': 500, 
                'P': 800, 'Q': 1250, 'R': 2000, 'S': 3150
            };
            
            // 正常检验抽样方案 (详细数据)
            const normalSamplingPlans = {
                'A': {'0.010': '0 1','0.015': '0 1','0.025': '0 1','0.040': '0 1','0.065': '0 1','0.10': '0 1','0.15': '0 1', '0.25': '0 1','0.40': '0 1', '0.65': '0 1', '1.0': '0 1', '1.5': '0 1', '2.5': '0 1', '4.0': '0 1', '6.5': '0 1','10': '1 2','15': '1 2','25': '1 2','40': '2 3','65': '3 4' ,'100': '5 6','150': '7 8','250': '10 11','400': '14 15','650': '21 22','1000': '30 31'},
                'B': {'0.010': '0 1','0.015': '0 1','0.025': '0 1','0.040': '0 1','0.065': '0 1','0.10': '0 1','0.15': '0 1', '0.25': '0 1','0.40': '0 1', '0.65': '0 1', '1.0': '0 1', '1.5': '0 1', '2.5': '0 1', '4.0': '0 1', '6.5': '0 1','10': '1 2','15': '1 2','25': '2 3','40': '3 4','65': '5 6' ,'100': '7 8','150': '10 11','250': '14 15','400': '21 22','650': '30 31','1000': '44 45'},
                'C': {'0.010': '0 1','0.015': '0 1','0.025': '0 1','0.040': '0 1','0.065': '0 1','0.10': '0 1','0.15': '0 1', '0.25': '0 1','0.40': '0 1', '0.65': '0 1', '1.0': '0 1', '1.5': '0 1', '2.5': '0 1', '4.0': '0 1', '6.5': '1 2','10': '1 2','15': '2 3','25': '3 4','40': '5 6','65': '7 8' ,'100': '10 11','150': '14 15','250': '21 22','400': '30 31','650': '44 45','1000': '44 45'},
                'D': {'0.010': '0 1','0.015': '0 1','0.025': '0 1','0.040': '0 1','0.065': '0 1','0.10': '0 1','0.15': '0 1', '0.25': '0 1','0.40': '0 1', '0.65': '0 1', '1.0': '0 1', '1.5': '0 1', '2.5': '1 0', '4.0': '1 2', '6.5': '1 2','10': '2 3','15': '3 4','25': '5 6','40': '7 8','65': '10 11' ,'100': '14 15','150': '21 22','250': '30 31','400': '44 45','650': '44 45','1000': '44 45'},
                'E': {'0.010': '0 1','0.015': '0 1','0.025': '0 1','0.040': '0 1','0.065': '0 1','0.10': '0 1','0.15': '0 1', '0.25': '0 1','0.40': '0 1', '0.65': '0 1', '1.0': '0 1', '1.5': '0 1', '2.5': '1 2', '4.0': '1 2', '6.5': '2 3','10': '3 4','15': '5 6','25': '7 8','40': '10 11','65': '14 15' ,'100': '21 22','150': '30 31','250': '40 45','400': '40 45','650': '40 45','1000': '40 45'},
                'F': {'0.010': '0 1','0.015': '0 1','0.025': '0 1','0.040': '0 1','0.065': '0 1','0.10': '0 1','0.15': '0 1', '0.25': '0 1','0.40': '0 1', '0.65': '0 1', '1.0': '0 1', '1.5': '1 2', '2.5': '1 2', '4.0': '2 3', '6.5': '3 4','10': '5 6','15': '7 8','25': '10 11','40': '14 15','65': '21 22' ,'100': '21 22','150': '30 31','250': '40 45','400': '40 45','650': '40 45','1000': '40 45'},
                'G': {'0.010': '0 1','0.015': '0 1','0.025': '0 1','0.040': '0 1','0.065': '0 1','0.10': '0 1','0.15': '0 1', '0.25': '0 1','0.40': '0 1', '0.65': '0 1', '1.0': '1 2', '1.5': '1 2', '2.5': '2 3', '4.0': '3 4', '6.5': '5 6','10': '7 8','15': '10 11','25': '14 15','40': '21 22','65': '21 22' ,'100': '21 22','150': '30 31','250': '40 45','400': '40 45','650': '40 45','1000': '40 45'},
                'H': {'0.010': '0 1','0.015': '0 1','0.025': '0 1','0.040': '0 1','0.065': '0 1','0.10': '0 1','0.15': '0 1', '0.25': '0 1','0.40': '0 1', '0.65': '1 2', '1.0': '1 2', '1.5': '2 3', '2.5': '3 4', '4.0': '5 6', '6.5': '7 8','10': '14 15','15': '21 22','25': '21 22','40': '21 22','65': '21 22' ,'100': '21 22','150': '30 31','250': '40 45','400': '40 45','650': '40 45','1000': '40 45'},
                'J': {'0.010': '0 1','0.015': '0 1','0.025': '0 1','0.040': '0 1','0.065': '0 1','0.10': '0 1','0.15': '0 1', '0.25': '0 1','0.40': '1 2', '0.65': '1 2', '1.0': '2 3', '1.5': '3 4', '2.5': '5 6', '4.0': '7 8', '6.5': '10 11','10': '14 15','15': '21 22','25': '21 22','40': '21 22','65': '21 22' ,'100': '21 22','150': '30 31','250': '40 45','400': '40 45','650': '40 45','1000': '40 45'},
                'K': {'0.010': '0 1','0.015': '0 1','0.025': '0 1','0.040': '0 1','0.065': '0 1','0.10': '0 1','0.15': '0 1', '0.25': '1 2','0.40': '1 2', '0.65': '2 3', '1.0': '3 4', '1.5': '5 6', '2.5': '7 8', '4.0': '10 11', '6.5': '14 15','10': '21 22','15': '21 22','25': '21 22','40': '21 22','65': '21 22' ,'100': '21 22','150': '30 31','250': '40 45','400': '40 45','650': '40 45','1000': '40 45'},
                'L': {'0.010': '0 1','0.015': '0 1','0.025': '0 1','0.040': '0 1','0.065': '0 1','0.10': '0 1','0.15': '1 2', '0.25': '1 2','0.40': '2 3', '0.65': '3 4', '1.0': '5 6', '1.5': '7 8', '2.5': '10 11', '4.0': '14 16', '6.5': '21 22','10': '21 22','15': '21 22','25': '21 22','40': '21 22','65': '21 22' ,'100': '21 22','150': '30 31','250': '40 45','400': '40 45','650': '40 45','1000': '40 45'},
                'M': {'0.010': '0 1','0.015': '0 1','0.025': '0 1','0.040': '0 1','0.065': '0 1','0.10': '1 2','0.15': '1 2', '0.25': '2 3','0.40': '3 4', '0.65': '5 6', '1.0': '7 8', '1.5': '10 11', '2.5': '14 15', '4.0': '21 22', '6.5': '21 22','10': '21 22','15': '21 22','25': '21 22','40': '21 22','65': '21 22' ,'100': '21 22','150': '30 31','250': '40 45','400': '40 45','650': '40 45','1000': '40 45'},
                'N': {'0.010': '0 1','0.015': '0 1','0.025': '0 1','0.040': '0 1','0.065': '1 2','0.10': '1 2','0.15': '2 3', '0.25': '3 4','0.40': '5 6', '0.65': '7 8', '1.0': '10 11', '1.5': '14 15', '2.5': '21 22', '4.0': '21 22', '6.5': '21 22','10': '21 22','15': '21 22','25': '21 22','40': '21 22','65': '21 22' ,'100': '21 22','150': '30 31','250': '40 45','400': '40 45','650': '40 45','1000': '40 45'},
                'P': {'0.010': '0 1','0.015': '0 1','0.025': '0 1','0.040': '1 2','0.065': '1 2','0.10': '2 3','0.15': '3 4', '0.25': '5 6','0.40': '7 8', '0.65': '10 11', '1.0': '14 15', '1.5': '21 22', '2.5': '21 22', '4.0': '21 22', '6.5': '21 22','10': '21 22','15': '21 22','25': '21 22','40': '21 22','65': '21 22' ,'100': '21 22','150': '30 31','250': '40 45','400': '40 45','650': '40 45','1000': '40 45'},
                'Q': {'0.010': '0 1','0.015': '0 1','0.025': '1 2','0.040': '1 2','0.065': '2 3','0.10': '3 4','0.15': '5 6', '0.25': '7 8','0.40': '10 11', '0.65': '14 15', '1.0': '21 22', '1.5': '21 22', '2.5': '21 22', '4.0': '21 22', '6.5': '21 22','10': '21 22','15': '21 22','25': '21 22','40': '21 22','65': '21 22' ,'100': '21 22','150': '30 31','250': '40 45','400': '40 45','650': '40 45','1000': '40 45'},
                'R': {'0.010': '0 1','0.015': '0 1','0.025': '1 2','0.040': '2 3','0.065': '3 4','0.10': '5 6','0.15': '7 8', '0.25': '10 11','0.40': '14 15', '0.65': '21 22', '1.0': '21 22', '1.5': '21 22', '2.5': '21 22', '4.0': '21 22', '6.5': '21 22','10': '21 22','15': '21 22','25': '21 22','40': '21 22','65': '21 22' ,'100': '21 22','150': '30 31','250': '40 45','400': '40 45','650': '40 45','1000': '40 45'}
            };
            
            // 加严检验抽样方案 (简化的示例数据)
            const tightenedSamplingPlans = {
                'A': {'0.010': '0 1','0.015': '0 1','0.025': '0 1','0.040': '0 1','0.065': '0 1','0.10': '0 1','0.15': '0 1', '0.25': '0 1','0.40': '0 1', '0.65': '0 1', '1.0': '0 1', '1.5': '0 1', '2.5': '0 1', '4.0': '0 1', '6.5': '0 1','10': '0 1','15': '1 2','25': '1 2','40': '1 2','65': '2 3' ,'100': '3 4','150': '5 6','250': '8 9','400': '12 153','650': '18 19','1000': '27 28'},
                'B': {'0.010': '0 1','0.015': '0 1','0.025': '0 1','0.040': '0 1','0.065': '0 1','0.10': '0 1','0.15': '0 1', '0.25': '0 1','0.40': '0 1', '0.65': '0 1', '1.0': '0 1', '1.5': '0 1', '2.5': '0 1', '4.0': '0 1', '6.5': '0 1','10': '1 2','15': '1 2','25': '1 2','40': '2 3','65': '3 4' ,'100': '5 6','150': '8 9','250': '12 13','400': '18 19','650': '27 28','1000': '41 42'},
                'C': {'0.010': '0 1','0.015': '0 1','0.025': '0 1','0.040': '0 1','0.065': '0 1','0.10': '0 1','0.15': '0 1', '0.25': '0 1','0.40': '0 1', '0.65': '0 1', '1.0': '0 1', '1.5': '0 1', '2.5': '0 1', '4.0': '0 1', '6.5': '1 2','10': '1 2','15': '1 2','25': '2 3','40': '3 4','65': '5 6' ,'100': '8 9','150': '12 13','250': '18 19','400': '27 28','650': '41 42','1000': '41 42'},
                'D': {'0.010': '0 1','0.015': '0 1','0.025': '0 1','0.040': '0 1','0.065': '0 1','0.10': '0 1','0.15': '0 1', '0.25': '0 1','0.40': '0 1', '0.65': '0 1', '1.0': '0 1', '1.5': '0 1', '2.5': '1 0', '4.0': '1 2', '6.5': '1 2','10': '1 2','15': '2 3','25': '3 4','40': '5 6','65': '8 9' ,'100': '12 13','150': '18 19','250': '27 28','400': '41 42','650': '41 42','1000': '41 42'},
                'E': {'0.010': '0 1','0.015': '0 1','0.025': '0 1','0.040': '0 1','0.065': '0 1','0.10': '0 1','0.15': '0 1', '0.25': '0 1','0.40': '0 1', '0.65': '0 1', '1.0': '0 1', '1.5': '0 1', '2.5': '1 2', '4.0': '1 2', '6.5': '1 2','10': '2 3','15': '3 4','25': '5 6','40': '8 9','65': '12 13' ,'100': '18 19','150': '27 28','250': '41 42','400': '41 42','650': '41 42','1000': '41 42'},
                'F': {'0.010': '0 1','0.015': '0 1','0.025': '0 1','0.040': '0 1','0.065': '0 1','0.10': '0 1','0.15': '0 1', '0.25': '0 1','0.40': '0 1', '0.65': '0 1', '1.0': '0 1', '1.5': '1 2', '2.5': '1 2', '4.0': '1 2', '6.5': '2 3','10': '3 4','15': '5 6','25': '8 9','40': '12 13','65': '18 19' ,'100': '18 19','150': '27 28','250': '41 42','400': '41 42','650': '41 42','1000': '41 42'},
                'G': {'0.010': '0 1','0.015': '0 1','0.025': '0 1','0.040': '0 1','0.065': '0 1','0.10': '0 1','0.15': '0 1', '0.25': '0 1','0.40': '0 1', '0.65': '0 1', '1.0': '1 2', '1.5': '1 2', '2.5': '1 2', '4.0': '2 3', '6.5': '3 4','10': '5 6','15': '8 9','25': '12 13','40': '18 19','65': '18 19' ,'100': '18 19','150': '27 28','250': '41 42','400': '41 42','650': '41 42','1000': '41 42'},
                'H': {'0.010': '0 1','0.015': '0 1','0.025': '0 1','0.040': '0 1','0.065': '0 1','0.10': '0 1','0.15': '0 1', '0.25': '0 1','0.40': '0 1', '0.65': '1 2', '1.0': '1 2', '1.5': '1 2', '2.5': '2 3', '4.0': '3 4', '6.5': '5 6','10': '8 9','15': '12 13','25': '18 19','40': '18 19','65': '18 19' ,'100': '18 19','150': '27 28','250': '41 42','400': '41 42','650': '41 42','1000': '41 42'},
                'J': {'0.010': '0 1','0.015': '0 1','0.025': '0 1','0.040': '0 1','0.065': '0 1','0.10': '0 1','0.15': '0 1', '0.25': '0 1','0.40': '1 2', '0.65': '1 2', '1.0': '1 2', '1.5': '2 3', '2.5': '3 4', '4.0': '5 6', '6.5': '8 9','10': '12 13','15': '18 19','25': '18 19','40': '18 19','65': '18 19' ,'100': '18 19','150': '27 28','250': '41 42','400': '41 42','650': '41 42','1000': '41 42'},
                'K': {'0.010': '0 1','0.015': '0 1','0.025': '0 1','0.040': '0 1','0.065': '0 1','0.10': '0 1','0.15': '0 1', '0.25': '1 2','0.40': '1 2', '0.65': '1 2', '1.0': '2 3', '1.5': '3 4', '2.5': '5 6', '4.0': '8 9', '6.5': '12 13','10': '18 19','15': '18 19','25': '18 19','40': '18 19','65': '18 19' ,'100': '18 19','150': '27 28','250': '41 42','400': '41 42','650': '41 42','1000': '41 42'},
                'L': {'0.010': '0 1','0.015': '0 1','0.025': '0 1','0.040': '0 1','0.065': '0 1','0.10': '0 1','0.15': '1 2', '0.25': '1 2','0.40': '1 2', '0.65': '2 3', '1.0': '3 4', '1.5': '5 6', '2.5': '8 9', '4.0': '12 13', '6.5': '18 19','10': '18 19','15': '18 19','25': '18 19','40': '18 19','65': '18 19' ,'100': '18 19','150': '27 28','250': '41 42','400': '41 42','650': '41 42','1000': '41 42'},
                'M': {'0.010': '0 1','0.015': '0 1','0.025': '0 1','0.040': '0 1','0.065': '0 1','0.10': '1 2','0.15': '1 2', '0.25': '1 2','0.40': '2 3', '0.65': '3 4', '1.0': '5 6', '1.5': '8 9', '2.5': '12 13', '4.0': '18 19', '6.5': '18 19','10': '18 19','15': '18 19','25': '18 19','40': '18 19','65': '18 19' ,'100': '18 19','150': '27 28','250': '41 42','400': '41 42','650': '41 42','1000': '41 42'},
                'N': {'0.010': '0 1','0.015': '0 1','0.025': '0 1','0.040': '0 1','0.065': '1 2','0.10': '1 2','0.15': '1 2', '0.25': '2 3','0.40': '3 4', '0.65': '5 6', '1.0': '8 9', '1.5': '12 13', '2.5': '18 19', '4.0': '18 19', '6.5': '18 19','10': '18 19','15': '18 19','25': '18 19','40': '18 19','65': '18 19' ,'100': '18 19','150': '27 28','250': '41 42','400': '41 42','650': '41 42','1000': '41 42'},
                'P': {'0.010': '0 1','0.015': '0 1','0.025': '0 1','0.040': '1 2','0.065': '1 2','0.10': '1 2','0.15': '2 3', '0.25': '3 4','0.40': '5 6', '0.65': '8 9', '1.0': '12 13', '1.5': '18 19', '2.5': '18 19', '4.0': '18 19', '6.5': '18 19','10': '18 19','15': '18 19','25': '18 19','40': '18 19','65': '18 19' ,'100': '18 19','150': '27 28','250': '41 42','400': '41 42','650': '41 42','1000': '41 42'},
                'Q': {'0.010': '0 1','0.015': '0 1','0.025': '1 2','0.040': '1 2','0.065': '1 2','0.10': '2 3','0.15': '3 4', '0.25': '5 6','0.40': '8 9', '0.65': '12 13', '1.0': '18 19', '1.5': '18 19', '2.5': '18 19', '4.0': '18 19', '6.5': '18 19','10': '18 19','15': '18 19','25': '18 19','40': '18 19','65': '18 19' ,'100': '18 19','150': '27 28','250': '41 42','400': '41 42','650': '41 42','1000': '41 42'},
                'R': {'0.010': '0 1','0.015': '0 1','0.025': '1 2','0.040': '1 2','0.065': '2 3','0.10': '3 4','0.15': '5 6', '0.25': '8 9','0.40': '12 13', '0.65': '18 19', '1.0': '18 19', '1.5': '18 19', '2.5': '18 19', '4.0': '18 19', '6.5': '18 19','10': '18 19','15': '18 19','25': '18 19','40': '18 19','65': '18 19' ,'100': '18 19','150': '27 28','250': '41 42','400': '41 42','650': '41 42','1000': '41 42'},
                'S': {'0.010': '0 1','0.015': '0 1','0.025': '1 2','0.040': '1 2','0.065': '2 3','0.10': '3 4','0.15': '5 6', '0.25': '8 9','0.40': '12 13', '0.65': '18 19', '1.0': '18 19', '1.5': '18 19', '2.5': '18 19', '4.0': '18 19', '6.5': '18 19','10': '18 19','15': '18 19','25': '18 19','40': '18 19','65': '18 19' ,'100': '18 19','150': '27 28','250': '41 42','400': '41 42','650': '41 42','1000': '41 42'}
            };
            
            calculateBtn.addEventListener('click', calculateSamplingPlan);
            
            function calculateSamplingPlan() {
                // 获取用户输入
                const lotSizeInput = document.getElementById('lotSize').value;
                const lotSize = parseInt(lotSizeInput);
                // 新增检验水平和AQL获取
                const inspectionLevel = document.querySelector('input[name="inspectionLevel"]:checked').value;
                const aql = document.getElementById('aql').value;
                // 【关键修复】获取检验类型（原代码缺失这一步）
                const inspectionType = document.querySelector('input[name="inspectionType"]:checked').value;
                
                // 新增：处理批量为空的情况
                if (!lotSizeInput || isNaN(lotSize)) {
                    document.getElementById('sampleCode').textContent = 'N/A';
                    document.getElementById('sampleSize').textContent = 'N/A';
                    document.getElementById('acceptanceNumber').textContent = 'N/A';
                    document.getElementById('rejectionNumber').textContent = 'N/A';
                    document.getElementById('decisionRule').textContent = '请输入有效的批量';
                    resultCard.style.display = 'block';
                    return;
                }
                
                // 获取样本量字码
                const sampleCode = getSampleCode(lotSize, inspectionLevel);
                
                // 获取样本量
                const sampleSize = sampleSizeMap[sampleCode];
                
                // 获取抽样方案（现在inspectionType已定义，可正常判断）
                const samplingPlan = inspectionType === 'normal' 
                    ? normalSamplingPlans[sampleCode] 
                    : tightenedSamplingPlans[sampleCode];
                
                // 获取接收数和拒收数
                let ac = '', re = '';
                let decisionRule = 'd ≤ Ac 接收，d ≥ Re 拒收';
                
                if (sampleSize >= lotSize) {
                    // 全数检验
                    ac = '0';
                    re = '1';
                    decisionRule = '全数检验：发现任何不合格品即拒收';
                } else if (samplingPlan && samplingPlan[aql]) {
                    [ac, re] = samplingPlan[aql].split(' ');
                } else {
                    // 没有找到抽样方案
                    ac = 'N/A';
                    re = 'N/A';
                    decisionRule = '未找到对应的抽样方案';
                }
                
                // 显示结果
                document.getElementById('sampleCode').textContent = sampleCode;
                document.getElementById('sampleSize').textContent = sampleSize;
                document.getElementById('acceptanceNumber').textContent = ac;
                document.getElementById('rejectionNumber').textContent = re;
                document.getElementById('decisionRule').textContent = decisionRule;
                
                // 显示结果卡片
                resultCard.style.display = 'block';
                
                // 滚动到结果位置
                resultCard.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
            
            function getSampleCode(lotSize, inspectionLevel) {
                // 查找批量的范围
                const range = codeMap.find(range => lotSize >= range.min && lotSize <= range.max);
                
                if (!range) return 'B'; // 默认值
                
                // 根据检验水平返回对应的字码
                if (inspectionLevel.startsWith('S')) {
                    switch(inspectionLevel) {
                        case 'S-1': return range.s1;
                        case 'S-2': return range.s2;
                        case 'S-3': return range.s3;
                        case 'S-4': return range.s4;
                    }
                } else {
                    switch(inspectionLevel) {
                        case 'I': return range.g1;
                        case 'II': return range.g2;
                        case 'III': return range.g3;
                    }
                }
                
                return 'B'; // 默认值
            }
            
            // 初始化计算
            calculateSamplingPlan();
        });
    </script>
</body>

</html>
