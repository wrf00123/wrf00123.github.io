<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>我的导航 Pro - 灵动视界</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        darkMode: 'class',
        theme: {
          extend: {
            fontFamily: {
              sans: ['-apple-system', 'BlinkMacSystemFont', 'San Francisco', 'Inter', 'Noto Sans SC', 'sans-serif'],
            },
            colors: {
              glass: {
                100: 'rgba(255, 255, 255, 0.1)',
                200: 'rgba(255, 255, 255, 0.2)',
                300: 'rgba(255, 255, 255, 0.3)',
                400: 'rgba(255, 255, 255, 0.4)',
                border: 'rgba(255, 255, 255, 0.2)',
                dark: 'rgba(15, 23, 42, 0.6)',
              }
            },
            animation: {
              blob: "blob 10s infinite",
            },
            keyframes: {
              blob: {
                "0%": { transform: "translate(0px, 0px) scale(1)" },
                "33%": { transform: "translate(30px, -50px) scale(1.1)" },
                "66%": { transform: "translate(-20px, 20px) scale(0.9)" },
                "100%": { transform: "translate(0px, 0px) scale(1)" },
              },
            },
          }
        }
      }
    </script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+SC:wght@400;500;700&display=swap');
      
      body {
        font-family: 'Inter', 'Noto Sans SC', sans-serif;
        background-color: #f0f2f5; /* Fallback */
      }
      
      /* Hide Scrollbar but allow scroll */
      .scrollbar-hide::-webkit-scrollbar {
          display: none;
      }
      .scrollbar-hide {
          -ms-overflow-style: none;
          scrollbar-width: none;
      }
      
      html {
        scroll-behavior: smooth;
      }

      /* Glassmorphism Utilities */
      .glass-panel {
        background: rgba(255, 255, 255, 0.65);
        backdrop-filter: blur(16px);
        -webkit-backdrop-filter: blur(16px);
        border: 1px solid rgba(255, 255, 255, 0.3);
        box-shadow: 0 4px 30px rgba(0, 0, 0, 0.05);
      }
      
      .dark .glass-panel {
        background: rgba(15, 23, 42, 0.6);
        border: 1px solid rgba(255, 255, 255, 0.1);
        box-shadow: 0 4px 30px rgba(0, 0, 0, 0.3);
      }

      .glass-card {
        background: rgba(255, 255, 255, 0.4);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.4);
        box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.05);
      }
      
      .dark .glass-card {
        background: rgba(30, 41, 59, 0.4);
        border: 1px solid rgba(255, 255, 255, 0.05);
      }

      .glass-input {
        background: rgba(255, 255, 255, 0.5);
        backdrop-filter: blur(4px);
        border: 1px solid rgba(255, 255, 255, 0.3);
      }
      .dark .glass-input {
        background: rgba(0, 0, 0, 0.2);
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      /* Custom scrollbar for modal content */
      .custom-scrollbar::-webkit-scrollbar {
        width: 6px;
      }
      .custom-scrollbar::-webkit-scrollbar-track {
        background: transparent;
      }
      .custom-scrollbar::-webkit-scrollbar-thumb {
        background-color: rgba(156, 163, 175, 0.5);
        border-radius: 20px;
      }
      
      /* Animation Delays */
      .animation-delay-2000 { animation-delay: 2s; }
      .animation-delay-4000 { animation-delay: 4s; }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://aistudiocdn.com/react@^19.2.1",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.1/",
    "react/": "https://aistudiocdn.com/react@^19.2.1/",
    "lucide-react": "https://aistudiocdn.com/lucide-react@^0.556.0"
  }
}
</script>
<link rel="stylesheet" href="/index.css">
</head>
  <body class="bg-slate-50 text-slate-900 dark:bg-slate-950 dark:text-slate-100 transition-colors duration-500 overflow-x-hidden selection:bg-indigo-500 selection:text-white">
    
    <!-- Background Blobs (The "Aurora" Effect) -->
    <div class="fixed inset-0 z-[-1] overflow-hidden pointer-events-none">
        <div class="absolute top-0 left-[-10%] w-[50vw] h-[50vw] bg-purple-300/30 dark:bg-purple-900/20 rounded-full mix-blend-multiply dark:mix-blend-screen filter blur-[80px] opacity-70 animate-blob"></div>
        <div class="absolute top-0 right-[-10%] w-[50vw] h-[50vw] bg-blue-300/30 dark:bg-indigo-900/20 rounded-full mix-blend-multiply dark:mix-blend-screen filter blur-[80px] opacity-70 animate-blob animation-delay-2000"></div>
        <div class="absolute bottom-[-20%] left-[20%] w-[50vw] h-[50vw] bg-pink-300/30 dark:bg-fuchsia-900/20 rounded-full mix-blend-multiply dark:mix-blend-screen filter blur-[80px] opacity-70 animate-blob animation-delay-4000"></div>
    </div>

    <div id="root"></div>

    <script type="text/babel">
      const { useState, useMemo, useEffect, useRef } = React;

      // ==========================================
      // 默认数据
      // ==========================================
      const DEFAULT_WEBSITES = [
        { id: 'rec-1', title: 'GitHub', url: 'https://github.com', description: '全球最大的代码托管平台，开发者必备。', category: '推荐', tags: ['代码', '开源'] },
        { id: 'rec-2', title: 'ChatGPT', url: 'https://chat.openai.com', description: 'OpenAI 开发的最强人工智能聊天机器人。', category: '推荐', tags: ['AI', '助手'] },
        { id: 'dev-1', title: 'MDN Docs', url: 'https://developer.mozilla.org', description: 'Web 开发者的权威指南和文档。', category: '开发', tags: ['文档', '前端'] },
        { id: 'dev-3', title: '掘金', url: 'https://juejin.cn', description: '帮助开发者成长的社区，包含前沿技术文章。', category: '开发', tags: ['社区'] },
        { id: 'des-2', title: 'Figma', url: 'https://figma.com', description: '在线协作界面设计工具，团队协作首选。', category: '设计', tags: ['工具', 'UI/UX'] },
        { id: 'learn-1', title: 'Bilibili', url: 'https://www.bilibili.com', description: '国内知名的视频弹幕网站，学习资源丰富。', category: '学习', tags: ['视频'] }
      ];

      const DEFAULT_CATEGORIES = [
        { id: '推荐', label: '推荐', iconName: 'Star' },
        { id: '开发', label: '开发', iconName: 'Code2' },
        { id: '设计', label: '设计', iconName: 'Palette' },
        { id: '人工智能', label: 'AI & GPT', iconName: 'BrainCircuit' },
        { id: '工具', label: '工具', iconName: 'Zap' },
        { id: '学习', label: '学习', iconName: 'GraduationCap' },
        { id: '资讯', label: '资讯', iconName: 'Newspaper' },
        { id: '其他', label: '其他', iconName: 'Folder' },
      ];

      // ==========================================
      // SVG Icons
      // ==========================================
      const Icons = {
        Compass: (props) => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><circle cx="12" cy="12" r="10"/><polygon points="16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76"/></svg>),
        Search: (props) => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><circle cx="11" cy="11" r="8"/><line x1="21" x2="16.65" y1="21" y2="16.65"/></svg>),
        ExternalLink: (props) => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" x2="21" y1="14" y2="3"/></svg>),
        Star: (props) => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>),
        Code2: (props) => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="m18 16 4-4-4-4"/><path d="m6 8-4 4 4 4"/><path d="m14.5 4-5 16"/></svg>),
        Palette: (props) => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><circle cx="13.5" cy="6.5" r=".5"/><circle cx="17.5" cy="10.5" r=".5"/><circle cx="8.5" cy="7.5" r=".5"/><circle cx="6.5" cy="12.5" r=".5"/><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.01 17.461 2 12 2z"/></svg>),
        BrainCircuit: (props) => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z"/><path d="M12 18a3 3 0 0 0-6.474-3.512"/><path d="M9 13a4.5 4.5 0 0 0 3-4"/><path d="M9 13h11.5"/></svg>),
        Zap: (props) => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>),
        GraduationCap: (props) => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M22 10v6M2 10l10-5 10 5-10 5z"/><path d="M6 12v5c3 3 9 3 12 0v-5"/></svg>),
        Newspaper: (props) => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2v-9c0-1.1.9-2 2-2h2"/><path d="M18 14h-8"/><path d="M15 18h-5"/><path d="M10 6h8v4h-8V6Z"/></svg>),
        Telescope: (props) => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="m10.065 12.493-6.18 1.318a.934.934 0 0 0 .677 1.816l9.144-2.853a5.004 5.004 0 0 0-1.402-7.295l-3.356 2.014"/><ellipse cx="15" cy="15" rx="4" ry="11" transform="rotate(-45 15 15)"/><path d="M7 21L11.5 16.5"/></svg>),
        Heart: (props) => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/></svg>),
        Settings: (props) => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.09a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>),
        Plus: (props) => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M5 12h14"/><path d="M12 5v14"/></svg>),
        Trash2: (props) => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg>),
        Pencil: (props) => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>),
        X: (props) => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>),
        Sun: (props) => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg>),
        Moon: (props) => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></svg>),
        Download: (props) => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></svg>),
        Upload: (props) => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" x2="12" y1="3" y2="15"/></svg>),
        Folder: (props) => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z"/></svg>)
      };

      // ==========================================
      // Components
      // ==========================================

      const Modal = ({ isOpen, onClose, title, children }) => {
        if (!isOpen) return null;
        return (
          <div className="fixed inset-0 z-50 overflow-y-auto">
            <div className="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
              <div className="fixed inset-0 transition-opacity" aria-hidden="true" onClick={onClose}>
                <div className="absolute inset-0 bg-slate-500/30 dark:bg-black/40 backdrop-blur-md"></div>
              </div>

              <span className="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>

              <div className="inline-block align-bottom glass-panel rounded-2xl text-left overflow-hidden shadow-2xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg w-full ring-1 ring-white/20">
                <div className="px-6 py-5 border-b border-white/10 dark:border-white/5">
                  <div className="flex justify-between items-center">
                    <h3 className="text-xl leading-6 font-bold text-slate-900 dark:text-white" id="modal-title">
                      {title}
                    </h3>
                    <button onClick={onClose} className="p-1 rounded-full hover:bg-black/5 dark:hover:bg-white/10 text-slate-500 hover:text-slate-700 transition-colors">
                      <Icons.X className="w-5 h-5" />
                    </button>
                  </div>
                </div>
                <div className="px-6 py-4 max-h-[70vh] overflow-y-auto custom-scrollbar">
                  {children}
                </div>
              </div>
            </div>
          </div>
        );
      };

      const Header = ({ searchTerm, onSearchChange, toggleTheme, isDark, isManageMode, setManageMode }) => {
        return (
          <div className="glass-panel sticky top-0 z-20 border-b border-white/20 transition-all duration-300">
            <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
              <div className="flex flex-col md:flex-row md:items-center justify-between gap-4">
                <div className="flex items-center justify-between">
                   <div className="flex items-center gap-3">
                    <div className="bg-indigo-500/20 p-2 rounded-xl backdrop-blur-sm border border-indigo-400/20">
                      <Icons.Compass className="w-6 h-6 text-indigo-600 dark:text-indigo-300" />
                    </div>
                    <div>
                      <h1 className="text-xl font-bold text-slate-900 dark:text-white tracking-tight">灵动视界</h1>
                      <p className="text-xs text-slate-600 dark:text-slate-300 font-medium opacity-80">Design for Future</p>
                    </div>
                  </div>
                  
                  {/* Mobile Actions */}
                  <div className="flex md:hidden items-center gap-2">
                     <button 
                        onClick={() => setManageMode(!isManageMode)}
                        className={`p-2 rounded-xl transition-all ${isManageMode ? 'bg-indigo-500/20 text-indigo-600 dark:text-indigo-300' : 'text-slate-500 hover:bg-black/5 dark:text-slate-300 dark:hover:bg-white/10'}`}
                      >
                        <Icons.Settings className="w-5 h-5" />
                      </button>
                      <button 
                        onClick={toggleTheme}
                        className="p-2 text-slate-500 hover:bg-black/5 dark:text-slate-300 dark:hover:bg-white/10 rounded-xl transition-all"
                      >
                        {isDark ? <Icons.Sun className="w-5 h-5" /> : <Icons.Moon className="w-5 h-5" />}
                      </button>
                  </div>
                </div>

                <div className="flex items-center gap-4 flex-1 justify-end">
                  <div className="relative w-full md:w-96 group">
                    <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                      <Icons.Search className="h-4 w-4 text-slate-500 dark:text-slate-400 group-focus-within:text-indigo-500 transition-colors" />
                    </div>
                    <input
                      type="text"
                      value={searchTerm}
                      onChange={onSearchChange}
                      className="glass-input block w-full pl-9 pr-3 py-2.5 rounded-xl leading-5 text-slate-900 dark:text-slate-100 placeholder-slate-500 dark:placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 transition-all duration-200 sm:text-sm"
                      placeholder="探索无限可能..."
                    />
                  </div>

                  <div className="hidden md:flex items-center gap-3">
                     <button 
                        onClick={() => setManageMode(!isManageMode)}
                        title={isManageMode ? "退出管理模式" : "进入管理模式"}
                        className={`p-2.5 rounded-xl transition-all flex items-center gap-2 text-sm font-semibold backdrop-blur-md ${
                          isManageMode 
                            ? 'bg-indigo-500 text-white shadow-lg shadow-indigo-500/30 ring-1 ring-indigo-400' 
                            : 'bg-white/40 dark:bg-white/5 text-slate-700 dark:text-slate-200 hover:bg-white/60 dark:hover:bg-white/10 ring-1 ring-white/20'
                        }`}
                      >
                        <Icons.Settings className="w-4 h-4" />
                        {isManageMode ? '完成' : '管理'}
                      </button>
                      <button 
                        onClick={toggleTheme}
                        className="p-2.5 bg-white/40 dark:bg-white/5 text-slate-600 dark:text-slate-300 hover:bg-white/60 dark:hover:bg-white/10 rounded-xl transition-all ring-1 ring-white/20"
                      >
                        {isDark ? <Icons.Sun className="w-5 h-5" /> : <Icons.Moon className="w-5 h-5" />}
                      </button>
                  </div>
                </div>
              </div>
            </div>
            
            {/* Management Toolbar */}
            {isManageMode && (
              <div className="bg-indigo-50/50 dark:bg-slate-900/50 backdrop-blur-md border-t border-indigo-100/20">
                 <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3 flex gap-4 overflow-x-auto">
                    <button 
                      onClick={() => window.dispatchEvent(new CustomEvent('open-add-modal'))}
                      className="flex items-center gap-2 px-4 py-2 bg-indigo-500/90 hover:bg-indigo-600 text-white text-sm font-semibold rounded-xl transition-all shadow-lg shadow-indigo-500/20 whitespace-nowrap"
                    >
                      <Icons.Plus className="w-4 h-4" /> 新增网站
                    </button>
                    <div className="w-px h-8 bg-indigo-200/50 dark:bg-white/10 mx-2"></div>
                    <button 
                      onClick={() => window.dispatchEvent(new CustomEvent('export-data'))}
                      className="flex items-center gap-2 px-3 py-2 text-indigo-700 dark:text-indigo-300 bg-white/30 dark:bg-white/5 hover:bg-white/50 rounded-xl text-sm font-medium transition-colors whitespace-nowrap"
                    >
                      <Icons.Download className="w-4 h-4" /> 导出备份
                    </button>
                    <button 
                      onClick={() => document.getElementById('import-file').click()}
                      className="flex items-center gap-2 px-3 py-2 text-indigo-700 dark:text-indigo-300 bg-white/30 dark:bg-white/5 hover:bg-white/50 rounded-xl text-sm font-medium transition-colors whitespace-nowrap"
                    >
                      <Icons.Upload className="w-4 h-4" /> 导入备份
                    </button>
                    <input type="file" id="import-file" className="hidden" accept=".json" onChange={(e) => window.dispatchEvent(new CustomEvent('import-data', { detail: e.target.files[0] }))} />
                    
                    <button 
                      onClick={() => { if(confirm('确定要重置所有数据到初始状态吗？这将清空您所有的修改！')) window.dispatchEvent(new CustomEvent('reset-data')); }}
                      className="ml-auto text-xs text-slate-500 hover:text-red-500 underline transition-colors whitespace-nowrap"
                    >
                      重置默认数据
                    </button>
                 </div>
              </div>
            )}
          </div>
        );
      };

      const CategoryFilter = ({ categories, selectedCategory, onSelectCategory }) => {
        return (
          <div className="w-full overflow-x-auto pb-2 pt-1 scrollbar-hide">
            <div className="flex space-x-3 min-w-max px-1">
              <button
                 onClick={() => onSelectCategory('All')}
                 className={`flex items-center px-5 py-2.5 rounded-full text-sm font-semibold transition-all duration-300 backdrop-blur-sm shadow-sm
                   ${selectedCategory === 'All' 
                     ? 'bg-slate-900 dark:bg-white text-white dark:text-slate-900 shadow-lg scale-105' 
                     : 'bg-white/40 dark:bg-white/5 text-slate-600 dark:text-slate-300 border border-white/20 hover:bg-white/60 dark:hover:bg-white/10'
                   }`}
              >
                全部
              </button>
              {categories.map((cat) => {
                const Icon = Icons[cat.iconName] || Icons.Folder;
                const isSelected = selectedCategory === cat.id;
                return (
                  <button
                    key={cat.id}
                    onClick={() => onSelectCategory(cat.id)}
                    className={`
                      flex items-center px-5 py-2.5 rounded-full text-sm font-semibold transition-all duration-300 backdrop-blur-sm border shadow-sm
                      ${isSelected 
                        ? 'bg-slate-900 dark:bg-white text-white dark:text-slate-900 border-transparent shadow-lg scale-105' 
                        : 'bg-white/40 dark:bg-white/5 text-slate-600 dark:text-slate-300 border-white/20 hover:bg-white/60 dark:hover:bg-white/10'
                      }
                    `}
                  >
                    <Icon className={`w-4 h-4 mr-2 ${isSelected ? 'text-indigo-300 dark:text-indigo-600' : 'text-slate-400 opacity-80'}`} />
                    {cat.label}
                  </button>
                );
              })}
            </div>
          </div>
        );
      };

      const WebsiteCard = ({ website, isManageMode, onEdit, onDelete }) => {
        const [imgError, setImgError] = useState(false);
        const faviconUrl = `https://www.google.com/s2/favicons?domain=${website.url}&sz=128`;

        return (
          <div className="relative group h-full">
            <a 
              href={website.url} 
              target="_blank" 
              rel="noopener noreferrer"
              className={`
                glass-card flex flex-col rounded-3xl p-5 transition-all duration-300 h-full
                ${!isManageMode ? 'hover:scale-[1.02] hover:shadow-xl hover:bg-white/50 dark:hover:bg-slate-800/50' : ''}
              `}
            >
              <div className="flex items-start justify-between mb-4">
                <div className="flex items-center gap-4">
                  <div className="relative w-12 h-12 rounded-2xl bg-white/50 dark:bg-white/10 border border-white/20 flex items-center justify-center overflow-hidden shrink-0 shadow-sm group-hover:shadow-md transition-all">
                    {!imgError ? (
                      <img 
                        src={faviconUrl} 
                        alt={`${website.title} icon`} 
                        className="w-7 h-7 object-contain"
                        onError={() => setImgError(true)}
                      />
                    ) : (
                      <div className="text-indigo-500 font-bold text-lg">
                        {website.title.charAt(0).toUpperCase()}
                      </div>
                    )}
                  </div>
                  <div>
                    <h3 className="text-lg font-bold text-slate-900 dark:text-slate-100 leading-tight">
                      {website.title}
                    </h3>
                    <div className="flex items-center gap-1 mt-0.5">
                       <span className="w-1.5 h-1.5 rounded-full bg-green-400 inline-block"></span>
                       <span className="text-[10px] text-slate-400 uppercase tracking-wider font-semibold">Online</span>
                    </div>
                  </div>
                </div>
                {!isManageMode && <Icons.ExternalLink className="w-4 h-4 text-slate-400 dark:text-slate-500 group-hover:text-indigo-500 transition-colors" />}
              </div>
              
              <p className="text-slate-600 dark:text-slate-300 text-sm leading-relaxed mb-4 line-clamp-2 flex-grow min-h-[2.5em] font-medium opacity-90">
                {website.description}
              </p>

              {website.tags && website.tags.length > 0 && (
                <div className="flex flex-wrap gap-2 mt-auto pt-4 border-t border-slate-200/30 dark:border-white/5">
                  {website.tags.slice(0, 3).map(tag => (
                    <span key={tag} className="text-[11px] px-2.5 py-1 rounded-lg bg-indigo-50/50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-300 font-medium border border-indigo-100/20">
                      #{tag}
                    </span>
                  ))}
                </div>
              )}
            </a>
            
            {/* Management Overlay */}
            {isManageMode && (
              <div className="absolute -top-2 -right-2 flex gap-1 z-10 scale-90">
                <button 
                  onClick={(e) => { e.preventDefault(); onEdit(website); }}
                  className="p-2 bg-white/80 dark:bg-slate-700/80 backdrop-blur text-indigo-600 dark:text-indigo-300 rounded-full shadow-lg hover:scale-110 transition-transform"
                  title="编辑"
                >
                  <Icons.Pencil className="w-4 h-4" />
                </button>
                <button 
                  onClick={(e) => { e.preventDefault(); onDelete(website.id); }}
                  className="p-2 bg-white/80 dark:bg-slate-700/80 backdrop-blur text-red-500 rounded-full shadow-lg hover:scale-110 transition-transform"
                  title="删除"
                >
                  <Icons.Trash2 className="w-4 h-4" />
                </button>
              </div>
            )}
          </div>
        );
      };

      const Footer = () => (
        <footer className="glass-panel mt-auto border-t border-white/10">
          <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div className="flex flex-col md:flex-row items-center justify-between text-sm text-slate-500 dark:text-slate-400 font-medium">
              <p>© {new Date().getFullYear()} 灵动视界 (Nav Pro). Locally Stored.</p>
              <div className="flex items-center mt-4 md:mt-0 opacity-70 hover:opacity-100 transition-opacity">
                <span>Designed with</span>
                <Icons.Heart className="w-3.5 h-3.5 text-pink-500 mx-1 fill-current" />
                <span>React & Glassmorphism</span>
              </div>
            </div>
          </div>
        </footer>
      );

      // ==========================================
      // Main App
      // ==========================================

      const App = () => {
        // State
        const [websites, setWebsites] = useState(() => {
          const saved = localStorage.getItem('nav_websites');
          return saved ? JSON.parse(saved) : DEFAULT_WEBSITES;
        });
        const [categories, setCategories] = useState(() => {
            const saved = localStorage.getItem('nav_categories');
            return saved ? JSON.parse(saved) : DEFAULT_CATEGORIES;
        });
        
        const [searchTerm, setSearchTerm] = useState('');
        const [activeCategory, setActiveCategory] = useState('All');
        const [isManageMode, setManageMode] = useState(false);
        const [isModalOpen, setIsModalOpen] = useState(false);
        const [editingSite, setEditingSite] = useState(null);
        const [isDark, setIsDark] = useState(() => {
           return localStorage.getItem('nav_theme') === 'dark' || (!('nav_theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches);
        });

        // Form State
        const [formData, setFormData] = useState({
          title: '', url: '', description: '', category: '', tags: ''
        });

        // Effects
        useEffect(() => {
          localStorage.setItem('nav_websites', JSON.stringify(websites));
        }, [websites]);
        
        useEffect(() => {
            localStorage.setItem('nav_categories', JSON.stringify(categories));
        }, [categories]);

        useEffect(() => {
          if (isDark) {
            document.documentElement.classList.add('dark');
            localStorage.setItem('nav_theme', 'dark');
          } else {
            document.documentElement.classList.remove('dark');
            localStorage.setItem('nav_theme', 'light');
          }
        }, [isDark]);

        // Event Listeners
        useEffect(() => {
          const openAdd = () => openModal();
          const handleExport = () => exportData();
          const handleReset = () => {
              setWebsites(DEFAULT_WEBSITES);
              setCategories(DEFAULT_CATEGORIES);
              alert('数据已重置！');
          };
          const handleImport = async (e) => {
              const file = e.detail;
              if (!file) return;
              try {
                  const text = await file.text();
                  const json = JSON.parse(text);
                  if (json.websites && Array.isArray(json.websites)) {
                      setWebsites(json.websites);
                      if (json.categories) setCategories(json.categories);
                      alert('数据导入成功！');
                  } else {
                      alert('无效的数据文件格式');
                  }
              } catch (err) {
                  alert('导入失败: ' + err.message);
              }
          };

          window.addEventListener('open-add-modal', openAdd);
          window.addEventListener('export-data', handleExport);
          window.addEventListener('import-data', handleImport);
          window.addEventListener('reset-data', handleReset);
          return () => {
              window.removeEventListener('open-add-modal', openAdd);
              window.removeEventListener('export-data', handleExport);
              window.removeEventListener('import-data', handleImport);
              window.removeEventListener('reset-data', handleReset);
          }
        }, [websites, categories]);

        // Actions
        const toggleTheme = () => setIsDark(!isDark);
        
        const openModal = (site = null) => {
          if (site) {
            setEditingSite(site);
            setFormData({
              title: site.title,
              url: site.url,
              description: site.description,
              category: site.category,
              tags: site.tags ? site.tags.join(', ') : ''
            });
          } else {
            setEditingSite(null);
            setFormData({
              title: '', url: '', description: '', category: categories[0].id, tags: ''
            });
          }
          setIsModalOpen(true);
        };

        const closeModal = () => setIsModalOpen(false);

        const handleSave = (e) => {
          e.preventDefault();
          
          let catId = formData.category.trim();
          const catExists = categories.find(c => c.id === catId || c.label === catId);
          if (!catExists && catId) {
             const newCat = { id: catId, label: catId, iconName: 'Folder' };
             setCategories([...categories, newCat]);
          } else if (catExists) {
             catId = catExists.id;
          }

          const siteData = {
            id: editingSite ? editingSite.id : Date.now().toString(),
            title: formData.title,
            url: formData.url.startsWith('http') ? formData.url : `https://${formData.url}`,
            description: formData.description,
            category: catId,
            tags: formData.tags.split(/[,，]/).map(t => t.trim()).filter(Boolean)
          };

          if (editingSite) {
            setWebsites(websites.map(w => w.id === editingSite.id ? siteData : w));
          } else {
            setWebsites([...websites, siteData]);
          }
          closeModal();
        };

        const handleDelete = (id) => {
          if (confirm('确定要删除这个网站吗？')) {
            setWebsites(websites.filter(w => w.id !== id));
          }
        };

        const exportData = () => {
          const dataStr = JSON.stringify({ websites, categories }, null, 2);
          const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
          const exportFileDefaultName = `nav-backup-${new Date().toISOString().slice(0,10)}.json`;
          const linkElement = document.createElement('a');
          linkElement.setAttribute('href', dataUri);
          linkElement.setAttribute('download', exportFileDefaultName);
          linkElement.click();
        };

        const handleSearchChange = (e) => {
          setSearchTerm(e.target.value);
          if (e.target.value) setActiveCategory('All');
        };

        const groupedWebsites = useMemo(() => {
          const groups = {};
          categories.forEach(cat => { groups[cat.id] = []; });

          websites.forEach((site) => {
            const term = searchTerm.toLowerCase();
            const matchesSearch = 
              site.title.toLowerCase().includes(term) ||
              site.description.toLowerCase().includes(term) ||
              site.tags?.some(tag => tag.toLowerCase().includes(term));

            if (matchesSearch) {
               if (!groups[site.category]) groups[site.category] = [];
               groups[site.category].push(site);
            }
          });
          return groups;
        }, [searchTerm, websites, categories]);

        const scrollToCategory = (categoryId) => {
          setActiveCategory(categoryId);
          if (categoryId === 'All') {
             window.scrollTo({ top: 0, behavior: 'smooth' });
             return;
          }
          const element = document.getElementById(`category-${categoryId}`);
          if (element) {
            const headerOffset = 180;
            const elementPosition = element.getBoundingClientRect().top;
            const offsetPosition = elementPosition + window.pageYOffset - headerOffset;
            window.scrollTo({ top: offsetPosition, behavior: "smooth" });
          }
        };

        const hasResults = Object.values(groupedWebsites).some(group => group && group.length > 0);

        return (
          <div className="min-h-screen font-sans flex flex-col relative z-10">
            <Header 
              searchTerm={searchTerm} 
              onSearchChange={handleSearchChange} 
              toggleTheme={toggleTheme}
              isDark={isDark}
              isManageMode={isManageMode}
              setManageMode={setManageMode}
            />

            <main className="flex-grow max-w-7xl w-full mx-auto px-4 sm:px-6 lg:px-8 py-8">
              <div className="sticky top-[80px] z-10 pt-2 pb-6 -mx-4 px-4 sm:mx-0 sm:px-0">
                 <CategoryFilter 
                  categories={categories}
                  selectedCategory={activeCategory} 
                  onSelectCategory={scrollToCategory} 
                />
              </div>

              {hasResults ? (
                <div className="space-y-12 pb-12">
                  {categories.map((category) => {
                    const sites = groupedWebsites[category.id];
                    if (!sites || sites.length === 0) return null;

                    return (
                      <section key={category.id} id={`category-${category.id}`} className="scroll-mt-48">
                        <div className="flex items-center gap-3 mb-6 pl-2">
                          <div className="p-2 bg-white/40 dark:bg-white/10 rounded-xl backdrop-blur-sm shadow-sm ring-1 ring-white/20">
                             {Icons[category.iconName] ? React.createElement(Icons[category.iconName], { className: "w-5 h-5 text-indigo-500 dark:text-indigo-400" }) : <Icons.Folder className="w-5 h-5 text-indigo-500" />}
                          </div>
                          <h2 className="text-2xl font-bold text-slate-800 dark:text-slate-100 tracking-tight">{category.label}</h2>
                          <span className="text-xs font-bold text-indigo-500 bg-indigo-50 dark:bg-indigo-900/30 px-2.5 py-0.5 rounded-full border border-indigo-100 dark:border-indigo-800">
                            {sites.length}
                          </span>
                        </div>
                        
                        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                          {sites.map((site) => (
                            <WebsiteCard 
                              key={site.id} 
                              website={site} 
                              isManageMode={isManageMode}
                              onEdit={openModal}
                              onDelete={handleDelete}
                            />
                          ))}
                        </div>
                      </section>
                    );
                  })}
                </div>
              ) : (
                <div className="flex flex-col items-center justify-center py-24 text-center">
                  <div className="glass-panel p-6 rounded-full shadow-lg mb-6 animate-pulse">
                    <Icons.Telescope className="w-16 h-16 text-indigo-400" />
                  </div>
                  <h3 className="text-2xl font-bold text-slate-800 dark:text-slate-100 mb-2">未发现目标</h3>
                  <p className="text-slate-500 dark:text-slate-400 max-w-sm mx-auto mb-8 font-medium">
                    宇宙中似乎没有关于 "{searchTerm}" 的信号。
                  </p>
                  <button 
                    onClick={() => setSearchTerm('')}
                    className="px-6 py-2.5 bg-indigo-600 hover:bg-indigo-700 text-white rounded-full font-semibold shadow-lg shadow-indigo-500/30 transition-all transform hover:scale-105"
                  >
                    返回地球
                  </button>
                </div>
              )}
            </main>

            <Footer />
            
            {/* Add/Edit Modal */}
            <Modal
              isOpen={isModalOpen}
              onClose={closeModal}
              title={editingSite ? '编辑信号源' : '捕获新信号'}
            >
              <form onSubmit={handleSave} className="space-y-5">
                <div>
                  <label className="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">网站名称</label>
                  <input
                    type="text"
                    required
                    value={formData.title}
                    onChange={e => setFormData({...formData, title: e.target.value})}
                    className="glass-input w-full px-4 py-3 rounded-xl focus:ring-2 focus:ring-indigo-500 text-slate-900 dark:text-white"
                    placeholder="例如：GitHub"
                  />
                </div>
                <div>
                  <label className="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">网址 (URL)</label>
                  <input
                    type="text"
                    required
                    value={formData.url}
                    onChange={e => setFormData({...formData, url: e.target.value})}
                    className="glass-input w-full px-4 py-3 rounded-xl focus:ring-2 focus:ring-indigo-500 text-slate-900 dark:text-white"
                    placeholder="例如：https://github.com"
                  />
                </div>
                <div>
                  <label className="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">描述</label>
                  <textarea
                    required
                    value={formData.description}
                    onChange={e => setFormData({...formData, description: e.target.value})}
                    rows="3"
                    className="glass-input w-full px-4 py-3 rounded-xl focus:ring-2 focus:ring-indigo-500 text-slate-900 dark:text-white"
                    placeholder="简短描述这个网站的作用..."
                  ></textarea>
                </div>
                <div>
                  <label className="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">分类</label>
                  <div className="flex gap-2">
                     <select
                        value={categories.some(c => c.id === formData.category) ? formData.category : ''}
                        onChange={e => setFormData({...formData, category: e.target.value})}
                        className="glass-input w-full px-4 py-3 rounded-xl focus:ring-2 focus:ring-indigo-500 text-slate-900 dark:text-white"
                      >
                        {categories.map(cat => (
                          <option key={cat.id} value={cat.id}>{cat.label}</option>
                        ))}
                      </select>
                  </div>
                  <input 
                     type="text"
                     value={formData.category} 
                     onChange={e => setFormData({...formData, category: e.target.value})}
                     className="glass-input mt-3 w-full px-4 py-3 rounded-xl text-sm text-slate-900 dark:text-white"
                     placeholder="或者输入新的分类名称..."
                  />
                </div>
                <div>
                  <label className="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">标签</label>
                  <input
                    type="text"
                    value={formData.tags}
                    onChange={e => setFormData({...formData, tags: e.target.value})}
                    className="glass-input w-full px-4 py-3 rounded-xl focus:ring-2 focus:ring-indigo-500 text-slate-900 dark:text-white"
                    placeholder="用逗号分隔，例如：开源, 工具"
                  />
                </div>
                <div className="flex justify-end gap-3 pt-6 border-t border-white/10">
                  <button
                    type="button"
                    onClick={closeModal}
                    className="px-5 py-2.5 text-slate-600 dark:text-slate-300 bg-slate-100/50 dark:bg-slate-700/50 rounded-xl hover:bg-slate-200 dark:hover:bg-slate-600 transition-colors font-medium"
                  >
                    取消
                  </button>
                  <button
                    type="submit"
                    className="px-6 py-2.5 text-white bg-indigo-600 rounded-xl hover:bg-indigo-700 transition-all shadow-lg shadow-indigo-500/30 hover:scale-105 font-bold"
                  >
                    {editingSite ? '保存修改' : '立即发射'}
                  </button>
                </div>
              </form>
            </Modal>
          </div>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App />);
    </script>
  <script type="module" src="/index.tsx"></script>
</body>
</html>